From: Helmut Grohne <helmut@subdivi.de>
Date: Wed, 23 Nov 2016 21:19:38 +0100
Subject: cross compilation support

* Make pkg-config substitutable to provision it as <triplet>-pkg-config.
* Make the vpnc used by makeman.pl substitutable to use the build arch tool.
---
 Makefile   | 8 +++++---
 makeman.pl | 2 +-
 2 files changed, 6 insertions(+), 4 deletions(-)

diff --git a/Makefile b/Makefile
index 2130cb3..f3d5fb8 100644
--- a/Makefile
+++ b/Makefile
@@ -41,8 +41,9 @@ DOCDIR=$(PREFIX)/share/doc/vpnc
 # GPL incompliant though.
 #OPENSSL_GPL_VIOLATION=yes
 
-CRYPTO_LDADD = $(shell pkg-config --libs gnutls)
-CRYPTO_CFLAGS = $(shell pkg-config --cflags gnutls) -DCRYPTO_GNUTLS
+PKG_CONFIG ?= pkg-config
+CRYPTO_LDADD = $(shell $(PKG_CONFIG) --libs gnutls)
+CRYPTO_CFLAGS = $(shell $(PKG_CONFIG) --cflags gnutls) -DCRYPTO_GNUTLS
 CRYPTO_SRCS = crypto-gnutls.c
 
 ifeq ($(OPENSSL_GPL_VIOLATION), yes)
@@ -67,6 +68,7 @@ CFLAGS +=  $(shell libgcrypt-config --cflags) $(CRYPTO_CFLAGS)
 CPPFLAGS += -DVERSION=\"$(VERSION)\"
 LDFLAGS ?= -g
 LIBS += $(shell libgcrypt-config --libs) $(CRYPTO_LDADD)
+VPNC ?= ./vpnc
 
 ifeq ($(shell uname -s), SunOS)
 LIBS += -lnsl -lresolv -lsocket
@@ -82,7 +84,7 @@ vpnc : $(OBJS) vpnc.o
 	$(CC) $(LDFLAGS) -o $@ $^ $(LIBS)
 
 vpnc.8 : vpnc.8.template makeman.pl vpnc
-	./makeman.pl
+	./makeman.pl $(VPNC)
 
 cisco-decrypt : cisco-decrypt.o decrypt-utils.o
 	$(CC) $(LDFLAGS) -o $@ $^ $(LIBS)
diff --git a/makeman.pl b/makeman.pl
index cf241a1..62fb5af 100755
--- a/makeman.pl
+++ b/makeman.pl
@@ -21,7 +21,7 @@ use Fatal    qw(open close);
 use filetest qw(access);	# to always get errno-values on filetests
 use POSIX    qw(strftime setlocale LC_ALL);
 
-my $vpnc = './vpnc';
+my $vpnc = $ARGV[0];
 -e $vpnc or die "$0: Can't find $vpnc. Did you compile it?\n";
 -x $vpnc or die "$0: Can't execute $vpnc. Please check permissions.\n";
 
